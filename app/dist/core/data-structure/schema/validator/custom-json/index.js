"use strict";function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var InvalidJSON=require("./error/invalid-json"),CustomJSONValidator=function(){function a(b){_classCallCheck(this,a),this.locator=b}return _createClass(a,[{key:"valid",value:function valid(a,b){a.collection?this.validCollection(a,b):this.validSingle(a,b)}},{key:"validCollection",value:function validCollection(a,b){if(!Array.isArray(b))throw new InvalidJSON("Invalid type: \"".concat(_typeof(b),"\", array expected"));var c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,this.validSingle(a,g)}catch(a){d=!0,e=a}finally{try{c||null==h["return"]||h["return"]()}finally{if(d)throw e}}}},{key:"validProperties",value:function validProperties(a,b){var c=b["custom-json"].type,d=this.locator.locate("core/schema/validator/".concat(c)),e=b["custom-json"].options||{};for(var f in a)try{d.valid(e,a[f])}catch(b){throw new InvalidJSON("Invalid property \"".concat(f,"\": got ").concat(_typeof(a[f]),", ").concat(c," expected"))}}},{key:"validSingle",value:function validSingle(a,b){var c=this.locator.locate("core/schema/validator/json");if(c.valid(a,b),"object"!==_typeof(b))throw new InvalidJSON("Invalid type: \"".concat(_typeof(b),"\", object expected"));a["custom-json"]&&this.validProperties(b,a)}}]),a}();module.exports=CustomJSONValidator;